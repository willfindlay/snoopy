import os
import sys
import ctypes as ct
from collections import defaultdict

import bcc.syscall

import src.python.config as config

ARG_UNKNOWN = 0
ARG_INT = 1
ARG_STR = 2
ARG_PTR = 3

DEFAULT_ARGS = (ARG_INT,ARG_INT,ARG_INT,ARG_INT,ARG_INT,ARG_INT)
FORMAT = defaultdict(lambda: SyscallFormat())

class SyscallFormat:
    def __init__(self, arg_types=DEFAULT_ARGS, ret_type=ARG_INT):
        for i in range(len(arg_types), 6):
            arg_types = arg_types + (ARG_UNKNOWN)
        assert len(arg_types) == 6

        self.arg_types = arg_types
        self.ret_type = ret_type

    def flags(self, possible_flags, value):
        num_flags = len(possible_flags)

        all_flags_on = 2 ** num_flags - 1
        flag_bits = bin(value & all_flags_on)[2:].zfill(num_flags)
        flags = []

        for i,bit in enumerate(reversed(flag_bits)):
            if bit == '1':
                flags.append(possible_flags[i])

        return "|".join(flags)

    def format(self, syscall):
        args = []
        for i in range(6):
            if type(self.arg_types[i]) == tuple:
                args.append(self.flags(self.arg_types[i], syscall.args[i]))
            elif self.arg_types[i] == ARG_INT:
                args.append(int(syscall.args[i]))
            elif self.arg_types[i] == ARG_PTR:
                args.append(hex(syscall.args[i]))
            elif self.arg_types[i] == ARG_STR:
                arg = f"\"{ct.cast(syscall.str_args[i], ct.c_char_p).value.decode('utf-8')}\""
                #arg = arg.replace("\n",f"{config.color(4)}\\n{config.color(1)}")
                args.append(arg)
            else: # ARG_UNKNOWN
                break
        args = list(map(str,args))
        return f"{syscall.name}({', '.join(args)}) = {'?' if not syscall.finished else syscall.ret}"

# this looks ugly but this list is autogenerated from kernel 5.14 on an x86_64 architecture
# I'm going to have to find a way to autogenerate this to make it portable
# I might just add it to bcc utils and make a PR there
FORMAT[0  ] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[1  ] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[2  ] = SyscallFormat((ARG_STR, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[3  ] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[4  ] = SyscallFormat((ARG_STR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[5  ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[6  ] = SyscallFormat((ARG_STR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[7  ] = SyscallFormat((ARG_PTR, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[8  ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[9  ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_INT), ARG_INT)
FORMAT[10 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[11 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[12 ] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[13 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[14 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[15 ] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[16 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[17 ] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[18 ] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[19 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[20 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[21 ] = SyscallFormat((ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[22 ] = SyscallFormat((ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[23 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_UNKNOWN), ARG_INT)
FORMAT[24 ] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[25 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[26 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[27 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[28 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[29 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[30 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[31 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[32 ] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[33 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[34 ] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[35 ] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[36 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[37 ] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[38 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[39 ] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[40 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[41 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[42 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[43 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[44 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_INT, ARG_PTR, ARG_INT), ARG_INT)
FORMAT[45 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_INT, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[46 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[47 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[48 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[49 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[50 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[51 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[52 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[53 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[54 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[55 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_STR, ARG_PTR, ARG_UNKNOWN), ARG_INT)
FORMAT[56 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_PTR, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[57 ] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[58 ] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[59 ] = SyscallFormat((ARG_STR, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[60 ] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[61 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[62 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[63 ] = SyscallFormat((ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[64 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[65 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[66 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[67 ] = SyscallFormat((ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[68 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[69 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[70 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[71 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[72 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[73 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[74 ] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[75 ] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[76 ] = SyscallFormat((ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[77 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[78 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[79 ] = SyscallFormat((ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[80 ] = SyscallFormat((ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[81 ] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[82 ] = SyscallFormat((ARG_STR, ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[83 ] = SyscallFormat((ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[84 ] = SyscallFormat((ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[85 ] = SyscallFormat((ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[86 ] = SyscallFormat((ARG_STR, ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[87 ] = SyscallFormat((ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[88 ] = SyscallFormat((ARG_STR, ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[89 ] = SyscallFormat((ARG_STR, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[90 ] = SyscallFormat((ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[91 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[92 ] = SyscallFormat((ARG_STR, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[93 ] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[94 ] = SyscallFormat((ARG_STR, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[95 ] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[96 ] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[97 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[98 ] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[99 ] = SyscallFormat((ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[100] = SyscallFormat((ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[101] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[102] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[103] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[104] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[105] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[106] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[107] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[108] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[109] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[110] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[111] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[112] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[113] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[114] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[115] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[116] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[117] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[118] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[119] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[120] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[121] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[122] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[123] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[124] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[125] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[126] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[127] = SyscallFormat((ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[128] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[129] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[130] = SyscallFormat((ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[131] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[132] = SyscallFormat((ARG_STR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[133] = SyscallFormat((ARG_STR, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[134] = SyscallFormat((ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[135] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[136] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[137] = SyscallFormat((ARG_STR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[138] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[139] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[140] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[141] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[142] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[143] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[144] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[145] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[146] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[147] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[148] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[149] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[150] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[151] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[152] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[153] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[154] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[155] = SyscallFormat((ARG_STR, ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[156] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[157] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[158] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[159] = SyscallFormat((ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[160] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[161] = SyscallFormat((ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[162] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[163] = SyscallFormat((ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[164] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[165] = SyscallFormat((ARG_STR, ARG_STR, ARG_STR, ARG_INT, ARG_PTR, ARG_UNKNOWN), ARG_INT)
FORMAT[166] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[167] = SyscallFormat((ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[168] = SyscallFormat((ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[169] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[170] = SyscallFormat((ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[171] = SyscallFormat((ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[172] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[173] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[174] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[175] = SyscallFormat((ARG_PTR, ARG_INT, ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[176] = SyscallFormat((ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[177] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[178] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[179] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[180] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[181] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[182] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[183] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[184] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[185] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[186] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[187] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[188] = SyscallFormat((ARG_STR, ARG_STR, ARG_PTR, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[189] = SyscallFormat((ARG_STR, ARG_STR, ARG_PTR, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[190] = SyscallFormat((ARG_INT, ARG_STR, ARG_PTR, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[191] = SyscallFormat((ARG_STR, ARG_STR, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[192] = SyscallFormat((ARG_STR, ARG_STR, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[193] = SyscallFormat((ARG_INT, ARG_STR, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[194] = SyscallFormat((ARG_STR, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[195] = SyscallFormat((ARG_STR, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[196] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[197] = SyscallFormat((ARG_STR, ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[198] = SyscallFormat((ARG_STR, ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[199] = SyscallFormat((ARG_INT, ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[200] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[201] = SyscallFormat((ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[202] = SyscallFormat((ARG_PTR, ARG_INT, ARG_INT, ARG_PTR, ARG_PTR, ARG_INT), ARG_INT)
FORMAT[203] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[204] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[205] = SyscallFormat((ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[206] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[207] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[208] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN), ARG_INT)
FORMAT[209] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[210] = SyscallFormat((ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[211] = SyscallFormat((ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[212] = SyscallFormat((ARG_INT, ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[213] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[214] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[215] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[216] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[217] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[218] = SyscallFormat((ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[219] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[220] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[221] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[222] = SyscallFormat((ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[223] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[224] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[225] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[226] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[227] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[228] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[229] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[230] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[231] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[232] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[233] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[234] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[235] = SyscallFormat((ARG_STR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[236] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[237] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_PTR, ARG_INT, ARG_INT), ARG_INT)
FORMAT[238] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[239] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[240] = SyscallFormat((ARG_STR, ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[241] = SyscallFormat((ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[242] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN), ARG_INT)
FORMAT[243] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN), ARG_INT)
FORMAT[244] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[245] = SyscallFormat((ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[246] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[247] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_INT, ARG_PTR, ARG_UNKNOWN), ARG_INT)
FORMAT[248] = SyscallFormat((ARG_STR, ARG_STR, ARG_PTR, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[249] = SyscallFormat((ARG_STR, ARG_STR, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[250] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[251] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[252] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[253] = SyscallFormat((ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[254] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[255] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[256] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[257] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[258] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[259] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[260] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[261] = SyscallFormat((ARG_INT, ARG_STR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[262] = SyscallFormat((ARG_INT, ARG_STR, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[263] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[264] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[265] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[266] = SyscallFormat((ARG_STR, ARG_INT, ARG_STR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[267] = SyscallFormat((ARG_INT, ARG_STR, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[268] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[269] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[270] = SyscallFormat((ARG_INT, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[271] = SyscallFormat((ARG_PTR, ARG_INT, ARG_PTR, ARG_PTR, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[272] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[273] = SyscallFormat((ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[274] = SyscallFormat((ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[275] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_PTR, ARG_INT, ARG_INT), ARG_INT)
FORMAT[276] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[277] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[278] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[279] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_PTR, ARG_PTR, ARG_INT), ARG_INT)
FORMAT[280] = SyscallFormat((ARG_INT, ARG_STR, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[281] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_INT, ARG_PTR, ARG_INT), ARG_INT)
FORMAT[282] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[283] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[284] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[285] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[286] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[287] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[288] = SyscallFormat((ARG_INT, ARG_PTR, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[289] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[290] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[291] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[292] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[293] = SyscallFormat((ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[294] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[295] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[296] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[297] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[298] = SyscallFormat((ARG_PTR, ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[299] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN), ARG_INT)
FORMAT[300] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[301] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_STR), ARG_INT)
FORMAT[302] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[303] = SyscallFormat((ARG_INT, ARG_STR, ARG_PTR, ARG_PTR, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[304] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[305] = SyscallFormat((ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[306] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[307] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[308] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[309] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[310] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_PTR, ARG_INT, ARG_INT), ARG_INT)
FORMAT[311] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_PTR, ARG_INT, ARG_INT), ARG_INT)
FORMAT[312] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[313] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[314] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[315] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[316] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[317] = SyscallFormat((ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[318] = SyscallFormat((ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)
FORMAT[319] = SyscallFormat((ARG_STR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[320] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_STR, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[321] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[322] = SyscallFormat((ARG_INT, ARG_STR, ARG_PTR, ARG_PTR, ARG_INT, ARG_UNKNOWN), ARG_INT)
FORMAT[323] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[324] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[325] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[326] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_PTR, ARG_INT, ARG_INT), ARG_INT)
FORMAT[327] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_INT, ARG_INT, ARG_INT), ARG_INT)
FORMAT[328] = SyscallFormat((ARG_INT, ARG_PTR, ARG_INT, ARG_INT, ARG_INT, ARG_INT), ARG_INT)
FORMAT[329] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[330] = SyscallFormat((ARG_INT, ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[331] = SyscallFormat((ARG_INT, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN, ARG_UNKNOWN), ARG_INT)
FORMAT[332] = SyscallFormat((ARG_INT, ARG_STR, ARG_INT, ARG_INT, ARG_PTR, ARG_UNKNOWN), ARG_INT)
FORMAT[333] = SyscallFormat((ARG_INT, ARG_INT, ARG_INT, ARG_PTR, ARG_PTR, ARG_PTR), ARG_INT)

class Syscall:
    def __init__(self, num, ret=0, args=[], str_args=[], finished=False):
        self.format = FORMAT[num]
        self.num = num
        self.name = bcc.syscall.syscall_name(num).decode('utf-8')
        self.finished = finished

        # handle args
        self.args = list(args)
        self.str_args = list(str_args)
        self.ret = ret

    def __str__(self):
        return self.format.format(self)

    def __repr__(self):
        return str(self)

# must match the struct in bpf/defs.h
class SyscallData(ct.Structure):
    _fields_ = [("id", ct.c_uint64),
                ("pid_tgid", ct.c_uint64),
                ("args", ct.c_ulong * 6),
                ("str_args", (ct.c_char * 6) * 64),
                ("ret", ct.c_long)]

